language: android
dist: trusty
jdk: oraclejdk8
android:
    components:
        - build-tools-29.0.2
        - android-29
        - extra
matrix:
    fast_finish: true
    include:
        - name: "Compile Release Sources"
          script: ./gradlew compileReleaseSources
        - name: "Compile Release Unit Test Sources"
          script: ./gradlew compileReleaseUnitTestSources
        - name: "Local Unit Test"
          script: ./gradlew test --continue
        - name: "Instrumented Unit Test"
          script: ./gradlew connectedAndroidTest --continue
        - name: "Build everything"
          script: ./gradlew build

before_cache:
    - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
    - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
  
cache:
    directories:
        - .autoconf
        - $HOME/.m2
        - $HOME/.gradle/caches/
        - $HOME/.gradle/wrapper/